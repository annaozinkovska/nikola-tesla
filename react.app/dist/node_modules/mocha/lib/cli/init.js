'use strict';

/**
 * Command module for "init" command
 *
 * @private
 * @module
 */

var fs = require('fs');
var path = require('path');

exports.command = 'init <path>';

exports.description = 'create a client-side Mocha setup at <path>';

exports.builder = function (yargs) {
  return yargs.positional('path', {
    type: 'string',
    normalize: true
  });
};

exports.handler = function (argv) {
  var destdir = argv.path;
  var srcdir = path.join(__dirname, '..', '..');
  fs.mkdirSync(destdir, { recursive: true });
  var css = fs.readFileSync(path.join(srcdir, 'mocha.css'));
  var js = fs.readFileSync(path.join(srcdir, 'mocha.js'));
  var tmpl = fs.readFileSync(path.join(srcdir, 'lib', 'browser', 'template.html'));
  fs.writeFileSync(path.join(destdir, 'mocha.css'), css);
  fs.writeFileSync(path.join(destdir, 'mocha.js'), js);
  fs.writeFileSync(path.join(destdir, 'tests.spec.js'), '');
  fs.writeFileSync(path.join(destdir, 'index.html'), tmpl);
};